\chapter{Descrição do Projeto}
\label{ch.descricao-projeto}

O projeto consiste em uma aplicação, estruturada na arquitetura Cliente-Servidor, onde a principal entidade é um “Evento”, e os três principais atores que com ela interagem são as Pessoas, “Organizadores” e “Moderadores”.
Toda a aplicação gira em torno desses Eventos, como eles são criados, organizados e consumidos, portanto entender como ele se relaciona com os atores é o suficiente para entender a estrutura e funcionamento da aplicação.

Um Evento é, basicamente, um conjunto de dados correspondente a um evento cultural (tal qual um show, peça ou festival), contando com dados como nome, categoria, descrição, organizadores, data, local e uma imagem promocional.
Cada Evento tem uma página própria, onde todas as informações referentes são apresentadas com clareza. 
A \autoref{fig:classe-evento} representa como o Evento é estruturado, definindo então o Tipo Evento. 
Note que o Tipo Evento inclui uma lista de atualizações, denominada AtualizacaoEvento, que armazena pequenas atualizações de texto sobre o Evento.

\begin{figure}[H]
    \centering
    \caption[Tipo Evento]{Tipo Evento}
    \includegraphics[width = 0.6\linewidth]{figs/diagramas/diagrama-classe-evento.png}\\
    \fonte{Elaborada pelo autor.}
    \label{fig:classe-evento}
\end{figure}

% TODO 3.2 AFERIR EXISTENCIA DA HOMEPAGE
O ator denominado Pessoa representa a interação mais básica com a aplicação: um usuário, que não precisa estar logado, que acessa a plataforma para procurar dados sobre eventos culturais. 
Desta forma, é possível navegar pelas páginas voltadas à exibição de eventos, visto que elas não 
A página principal conta com um banner exibindo eventos em destaque, e uma seleção de eventos relevantes separados por categoria.
A página agenda oferece uma exibição dos eventos ao longo de um dia ou de uma semana.
Na agenda diária, os eventos são organizados pelo seu horário de início.
Já na agenda semanal, os eventos são organizados pela sua data marcada, mas também pelo seu horário de início, dispondo-os em uma grade, assim tomando a forma de uma agenda. 
Também existe uma página de busca, que permite filtrar e buscar por Eventos específicos, baseado em texto, data, horário, categoria e região. 
É possível, a qualquer momento, clicar em um Evento para navegar à sua página correspondente, onde são exibidas todas os seus detalhes.

O ator denominado Organizador representa uma entidade organizadora de eventos culturais, e é o responsável por criar e gerir os Eventos. 
Ao contrário do Usuário, o Organizador deve realizar seu cadastro, na página de cadastro, de maneira que seja possível estabelecer um contato. 
Uma vez feito login (utilizando dados do cadastro), é possível acessar páginas referentes às funções de Organizador, além das já disponíveis para Pessoas.
A página de novo evento permite preencher um formulário com dados de uma atividade cultural, resultando na criação de um novo evento, que será consumido pelos demais usuários.
Também é possível acessar uma página de perfil, onde são exibidos dados deste ator, e também uma lista dos eventos que gerencia.
Nesta lista, é possível ver todos os eventos deste denominado ator, verificar o status (se foi Aprovado, Reprovado ou se está Em Análise) de cada um, e ainda navegar para a página de edição e exclusão respectiva a cada evento. 
A página de edição de evento permite ao Organizador tomar duas ações relativas ao Evento: Editar os seus dados, ou adicionar uma Atualização de texto ao evento. 
Por fim, a página de exclusao de evento oferece a remoção de um determinado evento do sistema, caso seu Organizador assim o queira.

O terceiro ator é o Moderador, e ele assume uma função administrativa na plataforma: uma vez que Eventos criados por Organizadores não são imediatamente visíveis ao público, cabe à eles analisar, aprovar ou reprovar Eventos criados, de maneira que nenhum deles viole os termos de uso da plataforma (como, por exemplo, spam). 
Dado a natureza do papel que este ator exerce, os Moderadores não realizam cadastro como normal,mas são escolhidos pelos gestores da plataforma.
Na página de perfil do Moderador, há uma lista de eventos, bem como um botão que o leva à pagina de análise de evento.
Os eventos listados nesta página são aqueles designados à este Moderador, que estão em estado de análise, e devem ser analisados e ter seu status atualizado..
A página de análise de evento, que apenas o Moderador de um evento tem acesso, apresenta os dados de um determinado Evento em estado de análise, e permite que se atualize o seu status para 'Aprovado' ou 'Reprovado', a depender do julgamento.
Um Evento que é aprovado por um Moderador se torna visível aos usuários, ao passo que um reprovado é restringido, mas ainda pode ser editado para uma nova tentativa pelo Organizador responsável. 


O comportamento de cada um dos atores em relação à aplicação estão descrito na \autoref{fig:use-case-usuario} e \autoref{fig:use-case-moderador-organizador}, representados por meio de diagramas de caso de uso:

\begin{figure}[H]
    \centering
    \caption[Caso de Uso - Usuário]{Caso de Uso - Usuário}
    \includegraphics[width = 0.7\linewidth]{figs/diagramas/diagrama-casouso-usuario.png}\\
    \fonte{Elaborada pelo autor.}
    \label{fig:use-case-usuario}
\end{figure}

% TODO 3.2 CONT
% \begin{figure}[H]
%     \centering
%     \caption[Caso de Uso - Usuário]{Caso de Uso - Usuário}
%     \includegraphics[width = 0.7\linewidth]{figs/diagramas/diagrama-casouso-usuario-homeless.png}\\
%     \fonte{Elaborada pelo autor.}
%     \label{fig:use-case-usuario}
% \end{figure}

\begin{figure}[H]
    \centering
    \caption[Caso de Uso - Organizador e Moderador]{Caso de Uso - Organizador e Moderador}
    \includegraphics[width = 0.7\linewidth]{figs/diagramas/diagrama-casouso-orgmod.png}\\
    \fonte{Elaborada pelo autor.}
    \label{fig:use-case-moderador-organizador}
\end{figure}

Uma vez que definimos tanto o tipo Evento, quanto os atores do sistema, podemos entender como eles se estruturam e relacionam, e sintetizar em um diagrama Entidade-Relacionamento, representado na \autoref{fig:diagrama-banco}.

\begin{figure}[H]
    \centering
    \caption[Diagrama Entidade-Relacionamento]{Diagrama Entidade-Relacionamento}
    \includegraphics[width = 1.0\linewidth]{figs/diagramas/diagrama-banco.png}\\
    \fonte{Elaborada pelo autor.}
    \label{fig:diagrama-banco}
\end{figure}

Também é possível definir um diagrama de classes, que representa como estes dados vão ser implementados na aplicação, representado na \autoref{fig:diagrama-classe}. 
Vale notar que algumas das entidades neste diagrama se referem à outros aspectos da aplicação além do descrito nessta seção. 
Por exemplo, as classes \emph{JWTUser} e \emph{UsuarioAutenticado}, bem como seus relacionamentos com \emph{UsuarioAutenticado}, tomam esta forma em razão da estratégia de autenticação de usuário adotada pela plataforma. 

\begin{figure}[H]
    \centering
    \caption[Diagrama de Classe]{Diagrama de Classe}
    \includegraphics[width = 1.0\linewidth]{figs/diagramas/diagrama-classe.png}\\
    \fonte{Elaborada pelo autor.}
    \label{fig:diagrama-classe}
\end{figure}

De maneira sucinta, podemos dividir a plataforma nas seguintes telas principais, referentes aos seguintes atores:

% \begin{center}
%     \begin{tabular}{|c|c|c|}
%         \hline
%         Usuário & Organização & Moderador \\ 
%         \hline
%         Página Principal & \makecell{Listagem de Eventos \\ (para Gestão)} & \makecell{Listagem de Eventos \\ (para Análise)} \\  
%         Agenda Semanal & Criação de Eventos & \makecell{Página de Evento \\ (para Análise)} \\    
%         Agenda Mensal & \makecell{Página de Evento \\ (para Gestão)} &  \\    
%         Agenda Diária &   &  \\    
%         Busca de Eventos &  &  \\    
%         Página de Evento &  &  \\
%         \hline
%     \end{tabular}
% \end{center}

\begin{quadro}[H]
    \caption{Telas da aplicação separadas por tipo de Usuário.}
    % \resizebox{\textwidth}{!}{%
        \begin{tabular}{|c|c|c|}
            \hline
            \textbf{Pessoa} & \textbf{Organizador} & \textbf{Moderador} \\ 
            \hline
            Página Principal                              & Criação de Eventos                            & Análise de eventos                           \\  
            \makecell{Agenda Semanal  e \\ Agenda diária} & \makecell{Perfil com \\ Listagem de Eventos}  & \makecell{Perfil com \\ Listagem de Eventos} \\    
            Busca de Eventos                              & \makecell{Atualização e \\ Edição de Eventos} &                                              \\    
            Página de Evento                              &                                               &                                              \\  
            \hline
        \end{tabular}
    % }
\fonte{Elaborada pelo autor.}
\label{tabela:telas-aplicacao}
\end{quadro}

% \begin{quadro}[H]
% \caption{Telas da aplicação separadas por tipo de Usuário.}
% \resizebox{\textwidth}{!}{%
% \begin{tabular}{|
% >{\columncolor[HTML]{FFFFFF}}l |
% >{\columncolor[HTML]{FFFFFF}}l |
% >{\columncolor[HTML]{FFFFFF}}l |}
% \hline
% \multicolumn{1}{|c|}{\cellcolor[HTML]{FFFFFF}\textbf{Usuário}} &
% \multicolumn{1}{c|}{\cellcolor[HTML]{FFFFFF}\textbf{Organizador}} &
% \multicolumn{1}{c|}{\cellcolor[HTML]{FFFFFF}\textbf{Moderador}} \\ \hline
% Página Principal & \makecell{Listagem de Eventos \\ (para Gestão)} & \makecell{Listagem de Eventos \\ (para Análise)} \\  
% Agenda Semanal & Criação de Eventos & \makecell{Página de Evento \\ (para Análise)} \\    
% Agenda Mensal & \makecell{Página de Evento \\ (para Gestão)} &  \\    
% Agenda Diária &   &  \\    
% Busca de Eventos &  &  \\    
% Página de Evento &  &  \\ \hline
% \end{tabular}%
% }
% \fonte{Elaborada pelo autor.}
% \label{tabela:comparacao-datasets}
% \end{quadro}

\section{Tecnologias Utilizadas}
\label{sec.tecnologias-utilizadas}
    
Dado a natureza do projeto, seus objetivos e seus requisitos, é possível definir como ele será implementado, assim como as tecnologias escolhidas para tal. 

Em termos de arquitetura, a mais adequada é a Cliente-Servidor: ela permite que um \emph{Backend} (denominado Servidor) receba, armazene, processe, gerencie e sirva dados, de acordo com pedidos realizados por um \emph{Frontend} (denominado Cliente), através de requisições HTTP feitas através da internet. 
Esta arquitetura é vantajosa pois desacopla o \emph{Frontend} do \emph{Backend}, permitindo que sejam desenvolvidos em paralelo, com dependências reduzidas. 
O único co-requisito entre as duas partes é que elas sejam capazes de se comunicar por meio de requisições HTTP, o que não é uma funcionalidade incomum. 
Adicionalmente, ela permite que diversos Clientes diferentes se comuniquem com o mesmo Servidor, flexibilizando a natureza do Cliente, que pode ser desde uma aplicação web, até um aplicativo mobile.

A fim de garantir a segurança no credenciamento dos usuários, foi adotada uma estratégia de autenticação baseada em \emph{JSON Web Tokens}, ou JWTs.
Para realizar o login, o usuário deve enviar suas credenciais (e-mail e senha, por exemplo) para o servidor.
Uma vez que os dados são validados, o servidor os codifica em um Token, utilizando uma chave privada, e envia o envia de volta para o cliente.
Desta forma, o cliente pode acessar endpoints protegidos ao enviar o Token junto à requisição, para se identificar.
Quando o servidor recebe uma requisição em um endpoint protegido, ele verifica a presença do Token de autenticação, e então o decodifica, assim acessando os dados originalmente armazenados.
Desta forma, o servidor possui uma maneira segura de prover um meio de autenticação ao cliente, uma vez que apenas ele é capaz de codificar e decodificar o Token.
Note que o cliente em nenhum momento precisa se preocupar em processar o Token, uma vez que ele age apenas como uma chave de autenticação para ele.

Para o \emph{Backend} do projeto, foi empregado a linguagem de programação Java, junto ao \emph{framework} Springboot. 
Ele permitiu o desenvolvimento, de maneira robusta e confiável, de um meio para os Clientes acessarem as funcionalidades do Servidor, de maneira padronizada por uma API REST.
O \emph{framework} oferece amplo apoio para aplicações REST, como controladores REST, filtros de requisições HTTP, e acesso ao banco de dados via JDBC. Utilizando o filtro de requisições, foi possível implementar uma boa solução de autenticação de usuários via JWT, que foi a abordagem escolhida para esta tarefa. 

Para armazenar os dados de usuários de dos eventos, foi escolhido um banco de dados relacional tradicional, o PostgreSQL, devido a sua fácil utilização tanto com o Springboot quanto com a própria arquitetura Cliente-Servidor.

Para o \emph{Frontend}, o Cliente foi implementado como uma aplicação Web, a princípio. Este tipo de aplicação funciona bem na arquitetura Cliente-Servidor, visto que a própria natureza dela implica numa ênfase em requisições HTTP. Utilizando o \emph{framework} Angular, que emprega a linguagem TypeScript, é possível desenvolver uma aplicação robusta para navegadores web. Adicionalmente, aplicações utilizando Angular costumam se comportar bem em navegadores para aparelhos celulares, tornando-se assim uma escolha flexível.

Ambas as linguagens escolhidas são fortemente tipadas, e oferecem apoio à abordagem de programação orientada à objeto. Isto garante a plena comunicação entre cada componente da aplicação, e garante que ela se comporte exatamente como esperado, facilitando o desenvolvimento do projeto.

Deve-se notar que boa parte do público em potencial do serviço utilizaria aparelhos celulares para acessá-lo. Com isso em mente, também é possível desenvolver um aplicativo de celular que agisse como um Cliente. Soluções PWAs, ou \emph{Progressive Web Apps}, são as ideais, visto que permitem desenvolver aplicativos mobile utilizando ferramentas usadas no desenvolvimento web tradicional. No caso do Ionic, um \emph{framework} PWA, é empregado o próprio Angular, assim justificando ainda mais a escolha deste, visto que isto tornaria as aplicações web e mobile semelhantes, e reduziria o atrito no desenvolvimento paralelo das duas.
    
\section{Procedimentos de Validação}
\label{sec.procedimentos-validacao}

% TODO: TESTES
    
Para garantir o funcionamento do sistema, ele será testado durante e após o seu desenvolvimento, empregando a estratégia da Pirâmide de Testes, onde cada nível da pirâmide corresponde a um tipo de teste a ser executado na aplicação. Com essa estrutura, é possível testar a aplicação de maneira integral, garantindo que tudo esteja funcionando em todos os níveis possíveis.

A base da pirâmide são os Testes Unitários, onde cada componente da aplicação é testado de maneira individual, verificando se o seu comportamento, em isolação, é o esperado. São os testes mais baratos de serem implementados e garantem o funcionamento individual de cada peça do sistema. Eles podem ser implementados a nível de componentes, classes ou funções.

O meio da pirâmide corresponde aos Testes de Integração, que irão averiguar como os componentes, já testados pelos Testes Unitários, se comunicam entre si. É nesta etapa que são testadas conexões e integrações entre serviços, clientes e servidores e diferentes blocos da aplicação, bem como o funcionamento de páginas como um todo. Portanto, são realizados a nível de páginas, ou de  \emph{endpoints} completos.

O topo desta pirâmide diz respeito aos Testes Ponta-a-Ponta (ou End to End, E2E), que são os mais complexos. Eles testam a aplicação seguindo uma abordagem de Caixa-Preta, ou seja, desconsiderando o funcionamento mecânico da aplicação e verificando apenas o sistema como ele é apresentado para o usuário. Em outras palavras, é um teste que envolve utilizar a aplicação tal qual ela foi projetada para, em busca de erros, bugs e inconsistências. Devido à sua natureza, testes E2E são realizados em nível de aplicação.
   
\section{Produto Desenvolvido}
\label{sec.produto-desenvolvido}

Durante o período em que ocorreram as disciplinas TCC 1 e 2, foi desenvolvido um Produto Mínimo Viável, e totalmente funcional, desta aplicação. Uma plataforma que permite às entidades organizadoras de eventos os divulgarem, e, aos usuários, encontrarem eventos relevantes para participarem.  

O componente \emph{backend} desenvolvido conta com diversos \emph{endpoints}, por onde é possível acessar as funcionalidades do Servidor. 
Os dois principais grupos de \emph{endpoints} são relacionados aos Eventos, e aos Usuários.
Por meio deles, é possível tomar todas as ações da aplicação: 
Criar uma conta e fazer login se referem aos \emph{endpoints} de Usuarios. Já buscar e consumir eventos, bem como criar, editar, moderar e excluí-los, são funcionalidades dos \emph{endpoints} de eventos.
O compoente backend também conta com um sistema de autenticação via JWT, garantindo que apenas os usuários adequados tem acesso à determinados recursos protegidos.

O componente \emph{frontend} desenvolvido age como o Cliente que acessa os dados do Servidor, implementando páginas na web que utilizam suas funcionalidades. 
Ele acessa essas funcionalidades por meio de requisições HTTP aos \emph{endpoints} do Servidor, por meio de um serviço que oferece funcionalidades de HTTP.
Como usuário, é possível procurar eventos por meio de filtros de busca, e ver seus detalhes além de conseguir visualizar todos os eventos que ocorrem em um determinado dia ou semana, por meio de uma agenda. 
Como um Organizador, é possível criar, editar e excluir eventos, e como um Moderador, é possível analisar e moderar os eventos.
É possível se identificar por meio de um sistema de login, que mantém o usuário ativo por meio de \emph{cookies} de navegador.

A identidade visual da adotada, embora não seja a final, reflete a visão da plataforma, visando ser sóbria, mas descontraída. Assim, ela emprega  um design claro e colorido. 

% TODO: figuras

As seguintes figuras, \autoref{fig:captura-busca} e \autoref{fig:captura-evento}, são capturas das respectivas telas, mencionadas no parágrafo acima.

\begin{figure}[H]
    \centering
    \caption[Captura - Tela de Busca]{Captura - Tela de Busca}
    \includegraphics[width = 1.0\linewidth]{figs/03-descricao-projeto/captura-busca.png}\\
    \fonte{Elaborada pelo autor.}
    \label{fig:captura-busca}
\end{figure}

\begin{figure}[H]
    \centering
    \caption[Captura - Tela de Evento]{Captura - Tela de Evento}
    \includegraphics[width = 1.0\linewidth]{figs/03-descricao-projeto/captura-evento.png}\\
    \fonte{Elaborada pelo autor.}
    \label{fig:captura-evento}
\end{figure}